- Free Azure Account - Possible to do with Free Subscription

### Create our Free Azure Account
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/57fc1757-44c6-47e3-b461-cdd14ed890d2)

1. Sign up: [Azure Free Account](https://azure.microsoft.com/en-us/free/)
2. Login: [Azure Portal](https://portal.azure.com)

### Prepare Vulnerability Management Scanner
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/5d415b63-21ce-4729-8c7f-4c02b6b7c95f)


    Go to Azure Portal
    Navigate to the Marketplace and search for "OpenVAS secured and supported by HOSSTED"
    Choose the "Start with a pre-set configuration" option and select the weakest configuration.
    Click "Continue to Create VM"
    Configure the VM:
        Resource Group: Vulnerability-Management
        VM Name: OpenVAS (Take note of the region and Vnet–consider East US 2)
        Authentication: Username → azureuser / Cyberlab123!
        Monitoring: Disable Boot Diagnostic
    Click "Create" to create the VM.
    Once the VM is created, SSH into it using PowerShell (Windows) or Terminal (MacOS) with the provided credentials.
    Wait until the deployment of OpenVAS is complete.


### Create Client Virtual Machine and Make it Vulnerable
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/dfea9c24-afcd-40f8-b49b-b4018a9b560e)


    Go to Azure Portal
    Search for Virtual Machines and create a new Virtual Machine.
    Configure the VM:
        Resource Group: Vulnerability-Management
        VM Name: Win10-Vulnerable
        Region: Same as the OpenVAS VM (East US 2)
        Virtual Network: Same as OpenVAS
        Image: Windows 10 Pro
        Size: Any size with 2 vCPUs
        Username: azureuser / Cyberlab123!
        Networking: Same Vnet as OpenVAS
    Create the VM.
    Once the VM is created, ensure you can RDP into it with the provided credentials.
    After logging in, make the VM vulnerable:
        Disable the Windows Firewall
        Gather up some Old Software
        Install an Old Version of FireFox: Firefox Setup 97.0b5
        Install an Old Version of VLC Player: vlc-1.1.7-win32
        Install an Old Version of Adobe Reader: 10.0_AdbeRdr1000_en_US_1_
        Restart the VM.


### Configure OpenVAS to Perform First Unauthenticated Scan against our Vulnerable VM
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/d230e911-1c09-4d6f-9a93-24ca418762c9)


    Login to OpenVAS and navigate to Assets > Hosts > New Host.
    Add the Client VM PRIVATE IP Address.
    Create a New Target from the Host, name it "Azure Vulnerable VMs".
    Take note of the credentials. We will add SMB credentials later.
    Create a new Task:
        Name & Comment: "Scan - Azure Vulnerable VMs"
        Scan Targets: "Azure Vulnerable VMs"
    Save the Task.
    Start the "Scan - Azure Vulnerable VMs" Task.
    Once the scan is finished, click the date under "Last Report" to see the results.
    Take note of the Tabs, especially the "Results" tab.


### Make Configurations for Credentialed Scans (Within VM)
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/73ddd99a-1248-43d7-9338-08aefad493ff)


    
   1. Disable Windows Firewall.
   2. Disable User Account Control.
   3. Enable Remote Registry.
   4. Set Registry Key:
    Launch Registry Editor (regedit.exe) in "Run as administrator" mode.
    Navigate to HKEY_LOCAL_MACHINE hive.
    Open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key.
    Create a new DWORD (32-bit) value with the following properties:
    Name: LocalAccountTokenFilterPolicy
            Value: 1
            Close Registry Editor.
   5. Restart the VM.



### Make Configurations for Credentialed Scans (OpenVAS)
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/6c60abd5-924f-4418-adcd-497cc8a453ce)


   1. Go to Configuration > Credentials > New Credential.
   2. Name / Comment: "Azure VM Credentials".
   3. Allow Insecure Use: Yes.
   4. Username: azureuser.
   5. Password: Cyberlab123!
   6. Save.
   7. Go to Configuration > Targets > CLONE the Target we made before.
   8. NEW Name / Comment: "Azure Vulnerable VMs - Credentialed Scan".
   9. Ensure the Private IP is still accurate.
   10. Credentials > SMB > Select the Credentials we just made: Azure VM Credentials.
   11. Save.


### Execute Credentialed Scan against our Vulnerable Windows VM
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/a73c7a4a-1c68-4950-871b-d102b3152a5b)
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/8d445c20-6b39-47b9-9fc6-98cac03414e0)


    1. Within Greenbone / OpenVAS, go to Scans > Tasks.
    2. CLONE the "Scan - Azure Vulnerable VMs" Task and Edit it.
    3. Name / Comment: "Scan - Azure Vulnerable VMs - Credentialed".
    4. Targets: Azure Vulnerable VMs - Credentialed Scan.
    5. Save.
    6. Click the Play button to launch the new Credentialed Scan and wait for it to finish.


### Remediate Vulnerabilities

    1. Log back into your Win10-Vulnerable VM.
    2. Uninstall Adobe Reader, VLC Player, and Firefox.
    3. Restart the VM.
    4. Re-initiate the "Scan - Azure Vulnerable VMs - Credentialed" scan and observe the results.

![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/dadc8f51-be36-4520-aca4-7862f68ec05b)

### Verify Remediations
![image](https://github.com/m-cadle/Azure-Vulnerability-Management/assets/122918279/b5ae164d-afc2-4ec4-9774-48b8e9ee89d9)

Note that there are no longer Vulnerabilities for FireFox, VLC Player, or Adobe Reader!


